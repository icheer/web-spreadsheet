!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).WebSpreadsheet=e()}(this,(function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e}function s(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function c(t){let e;return s(t,(t=>e=t))(),e}function u(t,e,n){t.$$.on_destroy.push(s(e,n))}function a(t,e,n=e){return t.set(n),e}function d(t,e){t.appendChild(e)}function f(t,e,n){t.insertBefore(e,n||null)}function p(t){t.parentNode.removeChild(t)}function h(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function m(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function w(){return g("")}function x(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function y(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e,n){e in t?t[e]=n:y(t,e,n)}function v(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function $(t,e){t.value=null==e?"":e}function k(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}function A(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}}function _(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];o.selected=~e.indexOf(o.__value)}}function I(t,e,n){t.classList[n?"add":"remove"](e)}function M(t){const e={};for(const n of t)e[n.name]=n.value;return e}let S;function E(t){S=t}function N(){if(!S)throw new Error("Function called outside component initialization");return S}function R(t){N().$$.on_mount.push(t)}const O=[],T=[],z=[],D=[],C=Promise.resolve();let H=!1;function J(){H||(H=!0,C.then(B))}function L(){return J(),C}function G(t){z.push(t)}let U=!1;const j=new Set;function B(){if(!U){U=!0;do{for(let t=0;t<O.length;t+=1){const e=O[t];E(e),P(e.$$)}for(E(null),O.length=0;T.length;)T.pop()();for(let t=0;t<z.length;t+=1){const e=z[t];j.has(e)||(j.add(e),e())}z.length=0}while(O.length);for(;D.length;)D.pop()();H=!1,U=!1,j.clear()}}function P(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(G)}}const Y=new Set;function q(t,e){t&&t.i&&(Y.delete(t),t.i(e))}function X(t,e){t.d(1),e.delete(t.key)}function K(t,e,n,o,r,i,l,s,c,u,a,d){let f=t.length,p=i.length,h=f;const m={};for(;h--;)m[t[h].key]=h;const g=[],w=new Map,x=new Map;for(h=p;h--;){const t=d(r,i,h),s=n(t);let c=l.get(s);c?o&&c.p(t,e):(c=u(s,t),c.c()),w.set(s,g[h]=c),s in m&&x.set(s,Math.abs(h-m[s]))}const y=new Set,b=new Set;function v(t){q(t,1),t.m(s,a),l.set(t.key,t),a=t.first,p--}for(;f&&p;){const e=g[p-1],n=t[f-1],o=e.key,r=n.key;e===n?(a=e.first,f--,p--):w.has(r)?!l.has(o)||y.has(o)?v(e):b.has(r)?f--:x.get(o)>x.get(r)?(b.add(o),v(e)):(y.add(r),f--):(c(n,l),f--)}for(;f--;){const e=t[f];w.has(e.key)||c(e,l)}for(;p;)v(g[p-1]);return g}function Z(i,l,s,c,u,a,d=[-1]){const f=S;E(i);const h=i.$$={fragment:null,ctx:null,props:a,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:n(),dirty:d,skip_bound:!1};let m=!1;if(h.ctx=s?s(i,l.props||{},((t,e,...n)=>{const o=n.length?n[0]:e;return h.ctx&&u(h.ctx[t],h.ctx[t]=o)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](o),m&&function(t,e){-1===t.$$.dirty[0]&&(O.push(t),J(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(i,t)),e})):[],h.update(),m=!0,o(h.before_update),h.fragment=!!c&&c(h.ctx),l.target){if(l.hydrate){const t=function(t){return Array.from(t.childNodes)}(l.target);h.fragment&&h.fragment.l(t),t.forEach(p)}else h.fragment&&h.fragment.c();l.intro&&q(i.$$.fragment),function(t,n,i){const{fragment:l,on_mount:s,on_destroy:c,after_update:u}=t.$$;l&&l.m(n,i),G((()=>{const n=s.map(e).filter(r);c?c.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(G)}(i,l.target,l.anchor),B()}E(f)}let Q;"function"==typeof HTMLElement&&(Q=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});const F=()=>((Date.now()%1e3+Math.random())/117e-8).toString(16).replace(".","").slice(-3)+Math.random().toString(16).replace(/^0\./,""),V=(t,e)=>{if(!e||!e.length)return"";if("string"===typeof t){const n=e.find((e=>e.value===t));return n&&n.label||""}return t.map((t=>{const n=e.find((e=>e.value===t));return n&&n.label||""})).filter((t=>!!t)).join(",")};function W(){const t=document.querySelector("html").getAttribute("lang")||"";return/zh-/i.test(t)}const tt=[];function et(e,n=t){let o;const r=[];function l(t){if(i(e,t)&&(e=t,o)){const t=!tt.length;for(let t=0;t<r.length;t+=1){const n=r[t];n[1](),tt.push(n,e)}if(t){for(let t=0;t<tt.length;t+=2)tt[t][0](tt[t+1]);tt.length=0}}}return{set:l,update:function(t){l(t(e))},subscribe:function(i,s=t){const c=[i,s];return r.push(c),1===r.length&&(o=n(l)||t),i(e),()=>{const t=r.indexOf(c);-1!==t&&r.splice(t,1),0===r.length&&(o(),o=null)}}}}const nt=et([]),ot=et([]),rt=et(-1),it=et(-1),lt=et(0),st=et(0),ct=et({}),ut=et(null),at=et([]);let dt=!1;const ft=et(null),pt=et(null);function ht(t){ft.set(t)}function mt(t){t&&pt.set(t)}function gt(t){const{key:e,ctrlKey:n}=t;if(/Arrow/.test(e)&&t.preventDefault(),"z"===e&&n){if(!("TEXTAREA"===t.path[0].tagName))return;t.preventDefault(),async function(){let t=c(at),e=t.findIndex((t=>t.current));if(e<=0)return!1;t[e--].current=!1,t[e].current=!0,t=[...t];const{data:n,rowIndex:o,colIndex:r}=t[e];rt.set(o),it.set(r),dt=!0,ot.set([]),await L(),ot.set(Mt(n)),await L(),dt=!1,at.set(t),$t()}()}if("y"===e&&n){if(!("TEXTAREA"===t.path[0].tagName))return;t.preventDefault(),async function(){let t=c(at),e=t.findIndex((t=>t.current));if(-1===e||e>=t.length-1)return!1;dt=!0,t[e++].current=!1,t[e].current=!0,t=[...t];const{data:n,rowIndex:o,colIndex:r}=t[e];rt.set(o),it.set(r),dt=!0,ot.set([]),await L(),ot.set(Mt(n)),await L(),dt=!1,at.set(t),$t(),t.length}()}}function wt(t){t.preventDefault();const{key:e}=t;if(/^Arrow/.test(e))return"ArrowUp"===e&&bt(-1),"ArrowDown"===e&&bt(1),"ArrowLeft"===e&&vt(-1),void("ArrowRight"===e&&vt(1));"Tab"===e&&vt(1),"Escape"===e&&(!function(){const t=c(pt);t.methods&&t.methods.restoreMethod()}(),ut.set(null)),"Delete"!==e&&"Backspace"!==e||function(t=!1){const e=c(pt);if(!e.methods)return;e.methods.clearMethod()}()}function xt(t){if(!("TEXTAREA"===t.path[0].tagName))return;let{isComposing:e,data:n,inputType:o}=t;"insertLineBreak"!==o?("insertFromPaste"===o&&(n=c(ft).value),function(){const t=c(pt);t.methods&&t.methods.focusMethod()}(),e||function(t){const e=c(pt);e.methods&&e.methods.typeInMethod(t)}(n),c(ft).value=""):bt(1)}function yt(){return[c(rt),c(it)]}function bt(t=1){const[e,n]=[c(rt),c(lt)];e<=0&&t<0||e>=n&&t>0||(rt.update((e=>e+t)),kt(),$t())}function vt(t=1){const[e,n]=[c(it),c(st)];e<=0&&t<0||e>=n&&t>0||(it.update((e=>e+t)),kt(),$t())}function $t(){const t=c(pt);t&&t.scrollIntoViewIfNeeded()}function kt(){const t=c(ft);t.value="",t.focus()}function At(t){t=Object.assign({},t);for(let e in t){const n=typeof t[e];"function"===n?delete t[e]:"object"===n&&Array.isArray(t[e])?t[e]=[]:t[e]=""}return JSON.parse(JSON.stringify(t))}function _t(){ct.set({})}function It(){if(dt)return;const t=(...t)=>{!function(t,e,n){if(!t||!t.length)return;const[o,r]=yt(),i={data:t,rowIndex:o,colIndex:r,current:!0};e[n]&&(e[n].current=!1);e=e.slice(0,n+1),e=(e=[...e,i]).slice(-20),at.set(e)}(...t),function(t){const e=new CustomEvent("change",{detail:t,bubbles:!0,cancelable:!0,composed:!0}),n=c(ft);if(!n)return;n.dispatchEvent(e)}(...t)},e=c(at),n=JSON.parse(JSON.stringify(c(ot)));if(!e.length)return void t(n,e,-1);const o=e.findIndex((t=>t.current)),r=e[o];JSON.stringify(n)!==JSON.stringify(r.data)&&t(n,e,o)}function Mt(t){return JSON.parse(JSON.stringify(t))}function St(t,e,n){const o=t.slice();return o[65]=e[n],o[67]=n,o}function Et(t,e,n){const o=t.slice();return o[60]=e[n],o}function Nt(t,e,n){const o=t.slice();return o[60]=e[n],o}function Rt(t){let e,n,o,r;function i(t,e){return"nothing"===t[13]?Lt:"input"===t[13]?Jt:"date"===t[13]?Ht:"time"===t[13]?Ct:"select"===t[13]?Dt:"select-multi"===t[13]?zt:"image"===t[13]?Tt:Ot}let l=i(t),s=l(t);return{c(){e=m("div"),s.c(),y(e,"class",n="cell-wrap "+t[14]),y(e,"title",t[22]()),I(e,"active",t[3]),I(e,"editting",t[12]),I(e,"error",!!t[22]())},m(n,i){f(n,e,i),s.m(e,null),t[47](e),o||(r=x(e,"click",t[24]),o=!0)},p(t,o){l===(l=i(t))&&s?s.p(t,o):(s.d(1),s=l(t),s&&(s.c(),s.m(e,null))),16384&o[0]&&n!==(n="cell-wrap "+t[14])&&y(e,"class",n),16392&o[0]&&I(e,"active",t[3]),20480&o[0]&&I(e,"editting",t[12]),4210688&o[0]&&I(e,"error",!!t[22]())},d(n){n&&p(e),s.d(),t[47](null),o=!1,r()}}}function Ot(t){let e,n;return{c(){e=m("span"),n=g(t[1]),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){2&e[0]&&v(n,t[1])},d(t){t&&p(e)}}}function Tt(t){let e,n,o=t[1].length&&Gt(t),r=t[4].uploadApi&&jt(t);return{c(){o&&o.c(),e=w(),r&&r.c(),n=w()},m(t,i){o&&o.m(t,i),f(t,e,i),r&&r.m(t,i),f(t,n,i)},p(t,i){t[1].length?o?o.p(t,i):(o=Gt(t),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),t[4].uploadApi?r?r.p(t,i):(r=jt(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(t){o&&o.d(t),t&&p(e),r&&r.d(t),t&&p(n)}}}function zt(t){let e;function n(t,e){return t[3]?Bt:Pt}let o=n(t),r=o(t);return{c(){r.c(),e=w()},m(t,n){r.m(t,n),f(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&p(e)}}}function Dt(t){let e;function n(t,e){return t[3]?qt:Xt}let o=n(t),r=o(t);return{c(){r.c(),e=w()},m(t,n){r.m(t,n),f(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&p(e)}}}function Ct(t){let e;function n(t,e){return t[3]?Zt:Qt}let o=n(t),r=o(t);return{c(){r.c(),e=w()},m(t,n){r.m(t,n),f(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&p(e)}}}function Ht(t){let e;function n(t,e){return t[3]?Ft:Vt}let o=n(t),r=o(t);return{c(){r.c(),e=w()},m(t,n){r.m(t,n),f(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&p(e)}}}function Jt(t){let e;function n(t,e){return t[12]?Wt:te}let o=n(t),r=o(t);return{c(){r.c(),e=w()},m(t,n){r.m(t,n),f(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&p(e)}}}function Lt(e){let n;return{c(){n=m("span")},m(t,e){f(t,n,e)},p:t,d(t){t&&p(n)}}}function Gt(t){let e,n=[],o=new Map,r=t[1];const i=t=>t[67];for(let e=0;e<r.length;e+=1){let l=St(t,r,e),s=i(l);o.set(s,n[e]=Ut(s,l))}return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=w()},m(t,o){for(let e=0;e<n.length;e+=1)n[e].m(t,o);f(t,e,o)},p(t,l){270008322&l[0]&&(r=t[1],n=K(n,l,i,1,t,r,o,e.parentNode,X,Ut,e,St))},d(t){for(let e=0;e<n.length;e+=1)n[e].d(t);t&&p(e)}}}function Ut(t,e){let n,i,l,s,c,u,a,h;function w(){return e[45](e[65])}return{key:t,first:null,c(){n=m("span"),i=m("img"),s=m("span"),c=g("×"),y(i,"class","img"),i.src!==(l=e[65])&&y(i,"src",l),y(i,"alt",""),y(s,"class","img-remove"),y(s,"title",u=e[19]?"删除":"remove"),y(n,"class","img-wrap"),this.first=n},m(t,o){f(t,n,o),d(n,i),d(n,s),d(s,c),a||(h=[x(i,"click",w),x(s,"click",(function(){r(e[28](e[67]))&&e[28](e[67]).apply(this,arguments)})),x(n,"contextmenu",ne)],a=!0)},p(t,n){e=t,2&n[0]&&i.src!==(l=e[65])&&y(i,"src",l),524288&n[0]&&u!==(u=e[19]?"删除":"remove")&&y(s,"title",u)},d(t){t&&p(n),a=!1,o(h)}}}function jt(t){let e,n,r,i,l,s;return{c(){e=m("input"),n=m("span"),y(e,"class","file-uploader"),y(e,"type","file"),y(e,"accept",t[17]),e.disabled=t[15],y(n,"class",r="file-uploader-label "+(!t[18]||t[6]?"disabled":"")),y(n,"title",i=t[19]?"上传":"upload")},m(o,r){f(o,e,r),t[46](e),f(o,n,r),l||(s=[x(e,"change",t[27]),x(n,"click",t[26])],l=!0)},p(t,o){131072&o[0]&&y(e,"accept",t[17]),32768&o[0]&&(e.disabled=t[15]),262208&o[0]&&r!==(r="file-uploader-label "+(!t[18]||t[6]?"disabled":""))&&y(n,"class",r),524288&o[0]&&i!==(i=t[19]?"上传":"upload")&&y(n,"title",i)},d(r){r&&p(e),t[46](null),r&&p(n),l=!1,o(s)}}}function Bt(t){let e,n,r,i,l,s=t[19]?"请选择":"Select...",c=t[16],u=[];for(let e=0;e<c.length;e+=1)u[e]=Yt(Et(t,c,e));return{c(){e=m("select"),n=m("option"),r=g(s);for(let t=0;t<u.length;t+=1)u[t].c();n.__value="",n.value=n.__value,k(n,"display","none"),y(e,"class","multi"),e.multiple=!0,e.disabled=t[15],void 0===t[5]&&G((()=>t[44].call(e)))},m(o,s){f(o,e,s),d(e,n),d(n,r);for(let t=0;t<u.length;t+=1)u[t].m(e,null);t[43](e),_(e,t[5]),i||(l=[x(e,"change",t[44]),x(e,"blur",t[23])],i=!0)},p(t,n){if(524288&n[0]&&s!==(s=t[19]?"请选择":"Select...")&&v(r,s),65536&n[0]){let o;for(c=t[16],o=0;o<c.length;o+=1){const r=Et(t,c,o);u[o]?u[o].p(r,n):(u[o]=Yt(r),u[o].c(),u[o].m(e,null))}for(;o<u.length;o+=1)u[o].d(1);u.length=c.length}32768&n[0]&&(e.disabled=t[15]),65568&n[0]&&_(e,t[5])},d(n){n&&p(e),h(u,n),t[43](null),i=!1,o(l)}}}function Pt(t){let e,n,o=V(t[1],t[16])+"";return{c(){e=m("span"),n=g(o),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){65538&e[0]&&o!==(o=V(t[1],t[16])+"")&&v(n,o)},d(t){t&&p(e)}}}function Yt(t){let e,n,o,r=t[60].label+"";return{c(){e=m("option"),n=g(r),e.__value=o=t[60].value,e.value=e.__value,k(e,"height","25px"),k(e,"background","#fff")},m(t,o){f(t,e,o),d(e,n)},p(t,i){65536&i[0]&&r!==(r=t[60].label+"")&&v(n,r),65536&i[0]&&o!==(o=t[60].value)&&(e.__value=o,e.value=e.__value)},d(t){t&&p(e)}}}function qt(t){let e,n,r,i,l,s=t[19]?"请选择":"Select...",c=t[16],u=[];for(let e=0;e<c.length;e+=1)u[e]=Kt(Nt(t,c,e));return{c(){e=m("select"),n=m("option"),r=g(s);for(let t=0;t<u.length;t+=1)u[t].c();n.__value="",n.value=n.__value,k(n,"display","none"),y(e,"class","single"),e.disabled=t[15],void 0===t[5]&&G((()=>t[42].call(e)))},m(o,s){f(o,e,s),d(e,n),d(n,r);for(let t=0;t<u.length;t+=1)u[t].m(e,null);t[41](e),A(e,t[5]),i||(l=[x(e,"change",t[42]),x(e,"blur",t[23])],i=!0)},p(t,n){if(524288&n[0]&&s!==(s=t[19]?"请选择":"Select...")&&v(r,s),65536&n[0]){let o;for(c=t[16],o=0;o<c.length;o+=1){const r=Nt(t,c,o);u[o]?u[o].p(r,n):(u[o]=Kt(r),u[o].c(),u[o].m(e,null))}for(;o<u.length;o+=1)u[o].d(1);u.length=c.length}32768&n[0]&&(e.disabled=t[15]),65568&n[0]&&A(e,t[5])},d(n){n&&p(e),h(u,n),t[41](null),i=!1,o(l)}}}function Xt(t){let e,n,o=V(t[1],t[16])+"";return{c(){e=m("span"),n=g(o),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){65538&e[0]&&o!==(o=V(t[1],t[16])+"")&&v(n,o)},d(t){t&&p(e)}}}function Kt(t){let e,n,o,r=t[60].label+"";return{c(){e=m("option"),n=g(r),e.__value=o=t[60].value,e.value=e.__value},m(t,o){f(t,e,o),d(e,n)},p(t,i){65536&i[0]&&r!==(r=t[60].label+"")&&v(n,r),65536&i[0]&&o!==(o=t[60].value)&&(e.__value=o,e.value=e.__value)},d(t){t&&p(e)}}}function Zt(t){let e,n,r;return{c(){e=m("input"),y(e,"type","time"),e.disabled=t[15]},m(o,i){f(o,e,i),t[39](e),$(e,t[5]),n||(r=[x(e,"input",t[40]),x(e,"keyup",t[25]),x(e,"blur",t[23])],n=!0)},p(t,n){32768&n[0]&&(e.disabled=t[15]),65568&n[0]&&$(e,t[5])},d(i){i&&p(e),t[39](null),n=!1,o(r)}}}function Qt(t){let e,n;return{c(){e=m("span"),n=g(t[1]),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){2&e[0]&&v(n,t[1])},d(t){t&&p(e)}}}function Ft(t){let e,n,r;return{c(){e=m("input"),y(e,"type","date"),e.disabled=t[15]},m(o,i){f(o,e,i),t[37](e),$(e,t[5]),n||(r=[x(e,"input",t[38]),x(e,"keyup",t[25]),x(e,"blur",t[23])],n=!0)},p(t,n){32768&n[0]&&(e.disabled=t[15]),65568&n[0]&&$(e,t[5])},d(i){i&&p(e),t[37](null),n=!1,o(r)}}}function Vt(t){let e,n;return{c(){e=m("span"),n=g(t[1]),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){2&e[0]&&v(n,t[1])},d(t){t&&p(e)}}}function Wt(t){let e,n,r;return{c(){e=m("input"),y(e,"class",t[14]),y(e,"type","text"),e.disabled=t[15]},m(o,i){f(o,e,i),t[35](e),$(e,t[5]),n||(r=[x(e,"input",t[36]),x(e,"keyup",t[25]),x(e,"blur",t[23])],n=!0)},p(t,n){16384&n[0]&&y(e,"class",t[14]),32768&n[0]&&(e.disabled=t[15]),65568&n[0]&&e.value!==t[5]&&$(e,t[5])},d(i){i&&p(e),t[35](null),n=!1,o(r)}}}function te(t){let e,n,o=t[21](t[1])+"";return{c(){e=m("span"),n=g(o),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){2&e[0]&&o!==(o=t[21](t[1])+"")&&v(n,o)},d(t){t&&p(e)}}}function ee(e){let n,o=e[0].key&&Rt(e);return{c(){o&&o.c(),n=w(),this.c=t},m(t,e){o&&o.m(t,e),f(t,n,e)},p(t,e){t[0].key?o?o.p(t,e):(o=Rt(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&p(n)}}}const ne=t=>t.preventDefault();function oe(t,e,n){let o,r,i,l,s,d,f,p,h,m,g,w,x,y,b,v,$,k;u(t,rt,(t=>n(32,y=t))),u(t,it,(t=>n(33,b=t))),u(t,lt,(t=>n(52,v=t))),u(t,st,(t=>n(53,$=t))),u(t,ut,(t=>n(20,k=t)));let{row:A={}}=e,{column:_={}}=e,{id:I=""}=e,M="",S="",E="",N=!1,O=!1,z=!1,D=null,C=null,H=null,J=null,G=null,U=null;function j(t=!1){if(O)return;if(O=!0,!o&&!t)return;if(f)return;const{valid:e,message:r=""}=P();n(1,M=S||"");const i=_.key;return n(29,A[i]=M,A),A._errorMsg[i],n(29,A._errorMsg[i]=r,A),n(29,A._id=F(),A),n(29,A={...A}),setTimeout((()=>{O=!1}),1),e}function B(t=!1){N&&!t||f||["input","select","date"].includes(i)&&(n(1,M=""),n(5,S=""),j())}function P(){const[t,e]=function(){const[t,e]=yt();return[c(ot)[t],c(nt)[e]]}(),{validator:n=(()=>{})}=s,o=n(S,t,e),r={valid:!1,message:o};return o||(r.valid=!0),r}async function Y(){if(!f)return N||n(31,N=!0),await L(),C?C.focus():void 0}async function q(t){o&&(r||"input"===i&&(f||(n(31,N=!0),await L(),n(1,M=t),n(5,S=t),C.focus())))}function X(){f||(n(1,M=E),n(5,S=E),n(31,N=!1),kt())}R((()=>{!async function(){h>v&&lt.set(h);m>$&&st.set(m);await L(),n(1,M=A[_.key])}()}));return t.$$set=t=>{"row"in t&&n(29,A=t.row),"column"in t&&n(0,_=t.column),"id"in t&&n(30,I=t.id)},t.$$.update=()=>{1073741824&t.$$.dirty[0]|6&t.$$.dirty[1]&&n(3,o=I===y+"."+b),1&t.$$.dirty[0]&&n(34,s=_.params||{}),536870927&t.$$.dirty[0]|8&t.$$.dirty[1]&&(o?D&&(n(2,D.methods={typeInMethod:q,focusMethod:Y,clearMethod:B,restoreMethod:X},D),mt(D)):(s.computed&&n(1,M=s.computed(A,_)),n(31,N=!1),n(5,S=M),E=M)),8&t.$$.dirty[0]|1&t.$$.dirty[1]&&n(12,r=o&&N),1&t.$$.dirty[0]&&n(13,i=_.type||"input"),1&t.$$.dirty[0]&&n(4,l=_.props||{}),1&t.$$.dirty[0]&&n(14,d="right"===_.align?"t-right":"center"===_.align?"t-center":"t-left"),17&t.$$.dirty[0]|8&t.$$.dirty[1]&&n(15,f=_.disabled||l.disabled||!!s.computed),17&t.$$.dirty[0]&&n(16,p=_.items||l.items||[]),1073741824&t.$$.dirty[0]&&(h=+I.split(".")[0]),1073741824&t.$$.dirty[0]&&(m=+I.split(".")[1]),16&t.$$.dirty[0]&&n(17,g=l.accept||"image/*"),18&t.$$.dirty[0]&&n(18,w=(l.max||100)>(M||[]).length)},n(19,x=W()),[_,M,D,o,l,S,z,C,H,J,G,U,r,i,d,f,p,g,w,x,k,function(t){null==t&&(t="");const{formatter:e=(t=>t)}=s,{valid:n}=P();return!0!==n?t:e(t)},function(){const t=_.key;if(!t||!A._errorMsg)return;return A._errorMsg[t]},j,function(t){const e=t.path[0],{tagName:r}=e;var i,l;if(["SPAN","DIV","IMG"].includes(r))if(o){if(f)return;n(31,N=!0),Y()}else i=h,l=m,rt.set(+i),it.set(+l),kt()},function(t){13===t.keyCode&&(j(),n(31,N=!1),bt(1))},function(){w&&(z||U.click())},function(t){const e=U.files[0];if(n(11,U.value=null,U),!e||!l.uploadApi)return;const o=new FormData;o.append("file",e),n(6,z=!0),fetch(l.uploadApi,{method:"POST",body:o}).then((t=>t.json())).then((t=>{const e=t=>{const n=typeof t;let o;if(t){if("string"===n&&/^https?:\/\//.test(t))return t;if("object"===n)for(let n in t)if(o=e(t[n]),o)break;return o}},o=e(t);o&&n(1,M=[...M,o])})).catch((t=>{console.error(t)})).finally((()=>{n(6,z=!1)}))},function(t){M.splice(t,1),n(1,M=[...M])},A,I,N,y,b,s,function(t){T[t?"unshift":"push"]((()=>{C=t,n(7,C)}))},function(){S=this.value,n(5,S),n(3,o),n(34,s),n(29,A),n(0,_),n(1,M),n(2,D),n(30,I),n(32,y),n(33,b),n(16,p),n(0,_),n(4,l)},function(t){T[t?"unshift":"push"]((()=>{J=t,n(9,J)}))},function(){S=this.value,n(5,S),n(3,o),n(34,s),n(29,A),n(0,_),n(1,M),n(2,D),n(30,I),n(32,y),n(33,b),n(16,p),n(0,_),n(4,l)},function(t){T[t?"unshift":"push"]((()=>{G=t,n(10,G)}))},function(){S=this.value,n(5,S),n(3,o),n(34,s),n(29,A),n(0,_),n(1,M),n(2,D),n(30,I),n(32,y),n(33,b),n(16,p),n(0,_),n(4,l)},function(t){T[t?"unshift":"push"]((()=>{H=t,n(8,H)}))},function(){S=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(5,S),n(3,o),n(34,s),n(29,A),n(0,_),n(1,M),n(2,D),n(30,I),n(32,y),n(33,b),n(16,p),n(0,_),n(4,l)},function(t){T[t?"unshift":"push"]((()=>{H=t,n(8,H)}))},function(){var t;t=this,S=[].map.call(t.querySelectorAll(":checked"),(t=>t.__value)),n(5,S),n(3,o),n(34,s),n(29,A),n(0,_),n(1,M),n(2,D),n(30,I),n(32,y),n(33,b),n(16,p),n(0,_),n(4,l)},t=>a(ut,k=t,k),function(t){T[t?"unshift":"push"]((()=>{U=t,n(11,U)}))},function(t){T[t?"unshift":"push"]((()=>{D=t,n(2,D),n(3,o),n(34,s),n(29,A),n(0,_),n(1,M),n(30,I),n(32,y),n(33,b)}))}]}function re(t){let e,n,o,r,i=t[3]&&ie(t),l=t[2]&&se(t);return{c(){e=m("div"),i&&i.c(),n=w(),l&&l.c(),y(e,"class","menu-wrap"),y(e,"style",t[4])},m(s,c){f(s,e,c),i&&i.m(e,null),d(e,n),l&&l.m(e,null),o||(r=x(e,"click",t[15]),o=!0)},p(t,o){t[3]?i?i.p(t,o):(i=ie(t),i.c(),i.m(e,n)):i&&(i.d(1),i=null),t[2]?l?l.p(t,o):(l=se(t),l.c(),l.m(e,null)):l&&(l.d(1),l=null),16&o&&y(e,"style",t[4])},d(t){t&&p(e),i&&i.d(),l&&l.d(),o=!1,r()}}}function ie(t){let e,n,o,r,i,l,s,c,u=t[6]?`第${t[3]}行`:`Row ${t[3]}`,a=t[6]?"插入行":"Insert line",h=t[5]&&le(t);return{c(){e=m("div"),n=g(u),o=m("div"),r=g(a),i=w(),h&&h.c(),l=w(),y(e,"class","line title"),y(o,"class","line item")},m(u,a){f(u,e,a),d(e,n),f(u,o,a),d(o,r),f(u,i,a),h&&h.m(u,a),f(u,l,a),s||(c=x(o,"click",t[12]),s=!0)},p(t,e){72&e&&u!==(u=t[6]?`第${t[3]}行`:`Row ${t[3]}`)&&v(n,u),64&e&&a!==(a=t[6]?"插入行":"Insert line")&&v(r,a),t[5]?h?h.p(t,e):(h=le(t),h.c(),h.m(l.parentNode,l)):h&&(h.d(1),h=null)},d(t){t&&p(e),t&&p(o),t&&p(i),h&&h.d(t),t&&p(l),s=!1,c()}}}function le(t){let e,n,o,r,i=t[6]?"删除行":"Delete line";return{c(){e=m("div"),n=g(i),y(e,"class","line item danger")},m(i,l){f(i,e,l),d(e,n),o||(r=x(e,"click",t[14]),o=!0)},p(t,e){64&e&&i!==(i=t[6]?"删除行":"Delete line")&&v(n,i)},d(t){t&&p(e),o=!1,r()}}}function se(t){let e,n,o,r;return{c(){e=m("div"),n=g("第"),o=g(t[2]),r=g("列"),y(e,"class","line title")},m(t,i){f(t,e,i),d(e,n),d(e,o),d(e,r)},p(t,e){4&e&&v(o,t[2])},d(t){t&&p(e)}}}function ce(e){let n,o=e[1]&&re(e);return{c(){o&&o.c(),n=w(),this.c=t},m(t,e){o&&o.m(t,e),f(t,n,e)},p(t,[e]){t[1]?o?o.p(t,e):(o=re(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&p(n)}}}function ue(t,e,n){let o,r,i,l,s,a,d,f,p,h,m;function g(t){t.stopPropagation(),_t()}u(t,ct,(t=>n(8,h=t))),u(t,lt,(t=>n(11,m=t)));return t.$$.update=()=>{256&t.$$.dirty&&n(0,o=h),1&t.$$.dirty&&n(1,r=o.show||!1),1&t.$$.dirty&&n(9,i=o.x||0),1&t.$$.dirty&&n(10,l=o.y||0),1&t.$$.dirty&&n(2,s=void 0===o.colIndex?void 0:o.colIndex+1),1&t.$$.dirty&&n(3,a=void 0===o.rowIndex?void 0:o.rowIndex+1),1536&t.$$.dirty&&n(4,d=`top: ${l}px; left: ${i}px;`),2048&t.$$.dirty&&n(5,f=m>0)},n(6,p=W()),[o,r,s,a,d,f,p,g,h,i,l,m,()=>{return t=o.rowIndex,ot.update((e=>{let n=e[t];return n=At(n),n._id=F(),e.splice(t,0,n),e})),void lt.update((t=>++t));var t},()=>{return t=o.rowIndex,void ot.update((e=>{let n=e[t];return n=At(n),e.splice(t,1,n),e}));var t},()=>function(t){let e=c(ot);e.splice(t,1),ot.set(e),lt.update((t=>--t))}(o.rowIndex),t=>g(t)]}customElements.define("sheet-cell",class extends Q{constructor(t){super(),this.shadowRoot.innerHTML="<style>.t-left{text-align:left}.t-center{text-align:center}.t-right{text-align:right}.cell-wrap{position:relative;width:100%;min-height:31px;height:100%;padding:3px 10px;box-sizing:border-box;font-size:15px;line-height:25px;overflow:visible}.cell-wrap.active{outline:2px solid #5292f7}.cell-wrap.error{outline:1px solid #f55}.cell-wrap.error.active{outline-width:2px}.cell-wrap span.value{display:block;max-width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:default}.cell-wrap .img-wrap{position:relative;display:inline-block;vertical-align:top;width:25px;height:25px;transition:transform 0.15s}.cell-wrap .img-wrap:hover{transform:scale(1.4);z-index:1}.cell-wrap .img-wrap:hover .img-remove{display:block}.cell-wrap .img-wrap+.img-wrap{margin-left:5px}.cell-wrap .img-wrap .img{position:relative;display:block;min-width:25px;min-height:25px;max-width:25px;max-height:25px;cursor:pointer}.cell-wrap .img-wrap .img-remove{display:none;position:absolute;z-index:1;top:-4px;right:-4px;width:14px;height:14px;line-height:13px;border-radius:50%;transform:scale(0.7);text-align:center;user-select:none;background:red;color:#fff;cursor:pointer}.cell-wrap .file-uploader{position:absolute;top:-2px;left:-2px;width:1px;height:1px;opacity:0}.cell-wrap .file-uploader-label{position:absolute;width:16px;height:16px;right:10px;top:7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAB+klEQVRYR+2WsU4bQRCG/9k9UFJRIqEookgaisjePQU5aUJHSZG4gIJYlmiSd8C8RKooQkKQKBRJkxoqGnsPhyJNUqSDPqIxtwxafAaDsO9ubWShcM3N3e3M/83caHYJI75oxPrwBigUghdS8g8AY8x4H0V23ScZL4BicSwU4vQbgEddomVj7HZeiNwAYRi8ZOYtAI9vEMsNkQtA62AO4M8AJvtkmgsiM4BSwTwRfwEwkYi7cr9J7K8Ayj6/IxOA1nIBgMv8QSLygYi2mXnHPRORq8xrZrzLC5EKMDuLyTiWR53AzPgURbYahsGrboBGI97VWn4EUL2EsFPG4LBfY6YCKDX+jMj+TIJsGWOXnH0TgHuvtdwEsOhsIcTzev2kPhBAqYSHrZaoENG/RsNudIL1AnDflZIrAI7j2H4/OMDxQAC9nPsB5JkFqb/gHuD/qkChgOlmE3+zNJFvE17XuGjCMJR7zCgxo5Jla/UB0Fq60e3GtjHGhudTtJOt1pKdzcxrUXRaS6uCD4BSokZEqy62MfZc+x7g7lZAKTwhkr/bfWOfRhH+pPXNUHvAiRWLmHH3/X38ShNvb1JDbMIsgtfX3B0An+yy+vScA93lyRpsgHXrxtjKlUGUTLZlAG8HCJzq6iatEGLXnSGvAKR63tIC7xPRsHhGDnAG+mhhMH7U/JEAAAAASUVORK5CYII=) 0 0 no-repeat;background-size:16px 16px;cursor:pointer}.cell-wrap .file-uploader-label.disabled{opacity:0.25;cursor:not-allowed}.cell-wrap input{border:none;outline:none;width:100%;height:100%;padding:0;font-size:15px}.cell-wrap input[disabled]{background:#fff}.cell-wrap select{position:absolute;z-index:1;top:0;left:0;width:100%;padding:0 6px;margin:0;border:none;outline:none;font-size:15px;overflow-y:auto}.cell-wrap select.single{height:100%}.cell-wrap select.multi{box-shadow:0 0 5px #888}</style>",Z(this,{target:this.shadowRoot,props:M(this.attributes)},oe,ee,l,{row:29,column:0,id:30},[-1,-1,-1]),t&&(t.target&&f(t.target,this,t.anchor),t.props&&(this.$set(t.props),B()))}static get observedAttributes(){return["row","column","id"]}get row(){return this.$$.ctx[29]}set row(t){this.$set({row:t}),B()}get column(){return this.$$.ctx[0]}set column(t){this.$set({column:t}),B()}get id(){return this.$$.ctx[30]}set id(t){this.$set({id:t}),B()}});function ae(t){let e,n,r,i,l,s,c;return{c(){e=m("div"),n=m("img"),i=m("div"),i.textContent="×",y(n,"class","img"),n.src!==(r=t[1])&&y(n,"src",r),y(n,"alt",""),k(n,"transform","scale("+t[2]+")"),y(i,"class","close"),y(e,"class",l="mask "+(t[0]?"fading-out":""))},m(o,r){f(o,e,r),d(e,n),d(e,i),s||(c=[x(n,"click",fe),x(n,"dragstart",pe),x(i,"click",t[5]),x(e,"mousewheel",t[4])],s=!0)},p(t,o){2&o&&n.src!==(r=t[1])&&y(n,"src",r),4&o&&k(n,"transform","scale("+t[2]+")"),1&o&&l!==(l="mask "+(t[0]?"fading-out":""))&&y(e,"class",l)},d(t){t&&p(e),s=!1,o(c)}}}function de(e){let n,o=e[3]&&ae(e);return{c(){o&&o.c(),n=w(),this.c=t},m(t,e){o&&o.m(t,e),f(t,n,e)},p(t,[e]){t[3]?o?o.p(t,e):(o=ae(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&p(n)}}}customElements.define("context-menu",class extends Q{constructor(t){super(),this.shadowRoot.innerHTML="<style>.menu-wrap{position:absolute;width:94px;background-color:#fff;box-shadow:0 0 4px #aaa;z-index:9}.menu-wrap .line{line-height:32px;font-size:14px;color:#888;text-align:center;cursor:default;white-space:nowrap}.menu-wrap .line.title{margin:0 10px;border-bottom:1px solid #eee}.menu-wrap .line.item{font-size:15px;color:#333;cursor:pointer}.menu-wrap .line.item:hover{background:#f1f1f1}.menu-wrap .line.item.danger:hover{background:#fff1f1}</style>",Z(this,{target:this.shadowRoot,props:M(this.attributes)},ue,ce,i,{}),t&&t.target&&f(t.target,this,t.anchor)}});const fe=t=>t.stopPropagation(),pe=t=>t.preventDefault();function he(t,e,n){let o,r;u(t,ut,(t=>n(1,r=t)));let i=!1,l=1;return t.$$.update=()=>{3&t.$$.dirty&&n(3,o=r||i)},[i,r,l,o,function(t){const{deltaY:e}=t;if(e<0){if(l>=2)return;n(2,l+=.1)}else{if(l<=.5)return;n(2,l-=.1)}},function(){a(ut,r=null,r),n(0,i=!0),setTimeout((()=>{n(0,i=!1),n(2,l=1)}),300)}]}function me(t,e,n){const o=t.slice();return o[16]=e[n],o[18]=n,o}function ge(t,e,n){const o=t.slice();return o[19]=e[n],o[21]=n,o}function we(t,e,n){const o=t.slice();return o[19]=e[n],o[21]=n,o}function xe(t,e,n){const o=t.slice();return o[19]=e[n],o[21]=n,o}function ye(t){let e;return{c(){e=m("colgroup")},m(t,n){f(t,e,n)},d(t){t&&p(e)}}}function be(t,e){let n,o;return{key:t,first:null,c(){n=m("colgroup"),y(n,"style",o=e[19].width?`width: ${e[19].width}`:""),this.first=n},m(t,e){f(t,n,e)},p(t,r){e=t,8&r&&o!==(o=e[19].width?`width: ${e[19].width}`:"")&&y(n,"style",o)},d(t){t&&p(n)}}}function ve(e){let n,o,r;return{c(){n=m("th"),n.textContent="#",y(n,"class","row-head")},m(t,i){f(t,n,i),o||(r=x(n,"contextmenu",e[12]),o=!0)},p:t,d(t){t&&p(n),o=!1,r()}}}function $e(t,e){let n,o,r,i,l=e[19].text+"";return{key:t,first:null,c(){n=m("th"),o=g(l),I(n,"highlight",e[21]===e[4]),this.first=n},m(t,l){f(t,n,l),d(n,o),r||(i=x(n,"contextmenu",e[13]),r=!0)},p(t,r){e=t,8&r&&l!==(l=e[19].text+"")&&v(o,l),24&r&&I(n,"highlight",e[21]===e[4])},d(t){t&&p(n),r=!1,i()}}}function ke(t){let e,n,o,r,i=t[18]+1+"";function l(...e){return t[14](t[18],...e)}return{c(){e=m("td"),n=g(i),y(e,"class","row-head"),I(e,"highlight",t[18]===t[6])},m(t,i){f(t,e,i),d(e,n),o||(r=x(e,"contextmenu",l),o=!0)},p(o,r){t=o,32&r&&i!==(i=t[18]+1+"")&&v(n,i),96&r&&I(e,"highlight",t[18]===t[6])},d(t){t&&p(e),o=!1,r()}}}function Ae(t,e){let n,o,r,i,l;return{key:t,first:null,c(){n=m("td"),o=m("sheet-cell"),b(o,"row",r=e[16]),b(o,"column",i=e[19]),b(o,"id",l=e[18]+"."+e[21]),this.first=n},m(t,e){f(t,n,e),d(n,o)},p(t,n){e=t,32&n&&r!==(r=e[16])&&b(o,"row",r),8&n&&i!==(i=e[19])&&b(o,"column",i),40&n&&l!==(l=e[18]+"."+e[21])&&b(o,"id",l)},d(t){t&&p(n)}}}function _e(t,e){let n,o,r=[],i=new Map,l=e[1]&&ke(e),s=e[3];const c=t=>t[21];for(let t=0;t<s.length;t+=1){let n=ge(e,s,t),o=c(n);i.set(o,r[t]=Ae(o,n))}return{key:t,first:null,c(){n=m("tr"),l&&l.c(),o=w();for(let t=0;t<r.length;t+=1)r[t].c();this.first=n},m(t,e){f(t,n,e),l&&l.m(n,null),d(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null)},p(t,u){(e=t)[1]?l?l.p(e,u):(l=ke(e),l.c(),l.m(n,o)):l&&(l.d(1),l=null),40&u&&(s=e[3],r=K(r,u,c,1,e,s,i,n,X,Ae,null,ge))},d(t){t&&p(n),l&&l.d();for(let t=0;t<r.length;t+=1)r[t].d()}}}function Ie(e){let n,r,i,l,s,c,u,a,h,g,b,v,$=[],k=new Map,A=[],_=new Map,I=[],M=new Map,S=e[1]&&ye(),E=e[3];const N=t=>t[21];for(let t=0;t<E.length;t+=1){let n=xe(e,E,t),o=N(n);k.set(o,$[t]=be(o,n))}let R=e[1]&&ve(e),O=e[3];const T=t=>t[21];for(let t=0;t<O.length;t+=1){let n=we(e,O,t),o=T(n);_.set(o,A[t]=$e(o,n))}let z=e[5];const D=t=>t[16][t[0]];for(let t=0;t<z.length;t+=1){let n=me(e,z,t),o=D(n);M.set(o,I[t]=_e(o,n))}return{c(){n=m("div"),r=m("image-preview"),i=m("textarea"),l=m("context-menu"),s=m("table"),S&&S.c(),c=w();for(let t=0;t<$.length;t+=1)$[t].c();u=m("thead"),a=m("tr"),R&&R.c(),h=w();for(let t=0;t<A.length;t+=1)A[t].c();g=m("tbody");for(let t=0;t<I.length;t+=1)I[t].c();this.c=t,y(i,"type","hidden"),y(n,"class","sheet-wrap")},m(t,o){f(t,n,o),d(n,r),d(n,i),e[11](i),d(n,l),d(n,s),S&&S.m(s,null),d(s,c);for(let t=0;t<$.length;t+=1)$[t].m(s,null);d(s,u),d(u,a),R&&R.m(a,null),d(a,h);for(let t=0;t<A.length;t+=1)A[t].m(a,null);d(s,g);for(let t=0;t<I.length;t+=1)I[t].m(g,null);b||(v=[x(window,"keydown",gt),x(window,"keyup",wt),x(window,"input",xt),x(n,"click",e[8])],b=!0)},p(t,[e]){t[1]?S||(S=ye(),S.c(),S.m(s,c)):S&&(S.d(1),S=null),8&e&&(E=t[3],$=K($,e,N,1,t,E,k,s,X,be,u,xe)),t[1]?R?R.p(t,e):(R=ve(t),R.c(),R.m(a,h)):R&&(R.d(1),R=null),24&e&&(O=t[3],A=K(A,e,T,1,t,O,_,a,X,$e,null,we)),235&e&&(z=t[5],I=K(I,e,D,1,t,z,M,g,X,_e,null,me))},i:t,o:t,d(t){t&&p(n),e[11](null),S&&S.d();for(let t=0;t<$.length;t+=1)$[t].d();R&&R.d();for(let t=0;t<A.length;t+=1)A[t].d();for(let t=0;t<I.length;t+=1)I[t].d();b=!1,o(v)}}}function Me(t,e,n){let o,r,i,l;u(t,nt,(t=>n(3,o=t))),u(t,it,(t=>n(4,r=t))),u(t,ot,(t=>n(5,i=t))),u(t,rt,(t=>n(6,l=t)));let{columns:s=[]}=e,{data:c=[]}=e,{key:a="_id"}=e,{showrowindex:d=!0}=e,f=null;var p;function h(t,e,n){t.preventDefault();const{layerX:o,layerY:r}=t;!function({x:t=0,y:e=0,rowIndex:n,colIndex:o}){const r={show:!0,x:t,y:e,rowIndex:n,colIndex:o};ct.set(r)}({x:o,y:r,rowIndex:e,colIndex:n})}R((()=>{ht(f),setTimeout((()=>{!function(t,e,n){nt.set(e),t.forEach((t=>{"_id"===n&&(t._id=F()),t._errorMsg={}})),ot.set(t)}(c,s,a)}),100)})),p=()=>{s.length&&c.length&&It()},N().$$.after_update.push(p);return t.$$set=t=>{"columns"in t&&n(9,s=t.columns),"data"in t&&n(10,c=t.data),"key"in t&&n(0,a=t.key),"showrowindex"in t&&n(1,d=t.showrowindex)},[a,d,f,o,r,i,l,h,function(){_t()},s,c,function(t){T[t?"unshift":"push"]((()=>{f=t,n(2,f)}))},t=>_t()||t.preventDefault(),t=>_t()||t.preventDefault(),(t,e)=>h(e,t)]}customElements.define("image-preview",class extends Q{constructor(t){super(),this.shadowRoot.innerHTML="<style>.mask{position:fixed;z-index:2999;top:0;left:0;width:100vw;height:100vh;background:rgba(0, 0, 0, 0.45);user-select:none;animation:fadeIn 0.3s}.mask.fading-out{animation:fadeOut 0.305s}.mask .img{display:block;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto auto;width:30vw;height:auto;transition:all 0.15s}.mask .close{position:absolute;top:25px;right:30px;width:34px;height:34px;border-radius:50%;border:3px solid #fff;color:#fff;text-align:center;line-height:32px;font-size:34px;opacity:0.85;cursor:pointer}.mask .close:hover{opacity:1}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{from{opacity:1}to{opacity:0}}</style>",Z(this,{target:this.shadowRoot,props:M(this.attributes)},he,de,l,{}),t&&t.target&&f(t.target,this,t.anchor)}});class Se extends Q{constructor(t){super(),this.shadowRoot.innerHTML="<style>textarea{position:fixed;top:0;left:0;width:0;height:0;opacity:0}.sheet-wrap{position:relative}.sheet-wrap table{position:relative;width:100%;padding:0;margin:0;overflow:visible;border-collapse:collapse;table-layout:fixed}.sheet-wrap table tr th,.sheet-wrap table tr td{min-height:25px;padding:0;border:1px solid #ddd;box-sizing:border-box;background-color:#fff}.sheet-wrap table tr th.row-head,.sheet-wrap table tr td.row-head{width:35px;background-color:#f8f8f8;color:#555;font-size:13.5px;box-sizing:border-box;text-align:center;white-space:nowrap;user-select:none}.sheet-wrap table tr th.highlight,.sheet-wrap table tr td.highlight{background-color:#ddd}.sheet-wrap table thead{position:relative}.sheet-wrap table thead th{position:sticky;top:0;z-index:1;transform:translateY(-1px);border-top-width:2px;background-color:#f8f8f8;color:#555}</style>",Z(this,{target:this.shadowRoot,props:M(this.attributes)},Me,Ie,i,{columns:9,data:10,key:0,showrowindex:1}),t&&(t.target&&f(t.target,this,t.anchor),t.props&&(this.$set(t.props),B()))}static get observedAttributes(){return["columns","data","key","showrowindex"]}get columns(){return this.$$.ctx[9]}set columns(t){this.$set({columns:t}),B()}get data(){return this.$$.ctx[10]}set data(t){this.$set({data:t}),B()}get key(){return this.$$.ctx[0]}set key(t){this.$set({key:t}),B()}get showrowindex(){return this.$$.ctx[1]}set showrowindex(t){this.$set({showrowindex:t}),B()}}return customElements.define("spread-sheet",Se),Se}));
