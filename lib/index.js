!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).WebSpreadsheet=e()}(this,(function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e}function s(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function c(t){let e;return s(t,(t=>e=t))(),e}function u(t,e,n){t.$$.on_destroy.push(s(e,n))}function a(t,e,n=e){return t.set(n),e}function d(t,e){t.appendChild(e)}function f(t,e,n){t.insertBefore(e,n||null)}function p(t){t.parentNode.removeChild(t)}function h(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function g(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function w(){return m("")}function x(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function y(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e,n){e in t?t[e]=n:y(t,e,n)}function v(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function $(t,e){t.value=null==e?"":e}function k(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}function A(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}}function _(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];o.selected=~e.indexOf(o.__value)}}function I(t,e,n){t.classList[n?"add":"remove"](e)}function M(t){const e={};for(const n of t)e[n.name]=n.value;return e}let E;function N(t){E=t}function S(){if(!E)throw new Error("Function called outside component initialization");return E}function R(t){S().$$.on_mount.push(t)}const O=[],T=[],z=[],C=[],D=Promise.resolve();let H=!1;function J(){H||(H=!0,D.then(B))}function L(){return J(),D}function G(t){z.push(t)}let U=!1;const j=new Set;function B(){if(!U){U=!0;do{for(let t=0;t<O.length;t+=1){const e=O[t];N(e),P(e.$$)}for(N(null),O.length=0;T.length;)T.pop()();for(let t=0;t<z.length;t+=1){const e=z[t];j.has(e)||(j.add(e),e())}z.length=0}while(O.length);for(;C.length;)C.pop()();H=!1,U=!1,j.clear()}}function P(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(G)}}const Y=new Set;function q(t,e){t&&t.i&&(Y.delete(t),t.i(e))}function X(t,e){t.d(1),e.delete(t.key)}function K(t,e,n,o,r,i,l,s,c,u,a,d){let f=t.length,p=i.length,h=f;const g={};for(;h--;)g[t[h].key]=h;const m=[],w=new Map,x=new Map;for(h=p;h--;){const t=d(r,i,h),s=n(t);let c=l.get(s);c?o&&c.p(t,e):(c=u(s,t),c.c()),w.set(s,m[h]=c),s in g&&x.set(s,Math.abs(h-g[s]))}const y=new Set,b=new Set;function v(t){q(t,1),t.m(s,a),l.set(t.key,t),a=t.first,p--}for(;f&&p;){const e=m[p-1],n=t[f-1],o=e.key,r=n.key;e===n?(a=e.first,f--,p--):w.has(r)?!l.has(o)||y.has(o)?v(e):b.has(r)?f--:x.get(o)>x.get(r)?(b.add(o),v(e)):(y.add(r),f--):(c(n,l),f--)}for(;f--;){const e=t[f];w.has(e.key)||c(e,l)}for(;p;)v(m[p-1]);return m}function Z(i,l,s,c,u,a,d=[-1]){const f=E;N(i);const h=i.$$={fragment:null,ctx:null,props:a,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:n(),dirty:d,skip_bound:!1};let g=!1;if(h.ctx=s?s(i,l.props||{},((t,e,...n)=>{const o=n.length?n[0]:e;return h.ctx&&u(h.ctx[t],h.ctx[t]=o)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](o),g&&function(t,e){-1===t.$$.dirty[0]&&(O.push(t),J(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(i,t)),e})):[],h.update(),g=!0,o(h.before_update),h.fragment=!!c&&c(h.ctx),l.target){if(l.hydrate){const t=function(t){return Array.from(t.childNodes)}(l.target);h.fragment&&h.fragment.l(t),t.forEach(p)}else h.fragment&&h.fragment.c();l.intro&&q(i.$$.fragment),function(t,n,i){const{fragment:l,on_mount:s,on_destroy:c,after_update:u}=t.$$;l&&l.m(n,i),G((()=>{const n=s.map(e).filter(r);c?c.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(G)}(i,l.target,l.anchor),B()}N(f)}let Q;"function"==typeof HTMLElement&&(Q=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});const F=()=>((Date.now()%1e3+Math.random())/117e-8).toString(16).replace(".","").slice(-3)+Math.random().toString(16).replace(/^0\./,""),V=(t,e)=>{if(!e||!e.length)return"";if("string"===typeof t){const n=e.find((e=>e.value===t));return n&&n.label||""}return t.map((t=>{const n=e.find((e=>e.value===t));return n&&n.label||""})).filter((t=>!!t)).join(",")},W=[];function tt(e,n=t){let o;const r=[];function l(t){if(i(e,t)&&(e=t,o)){const t=!W.length;for(let t=0;t<r.length;t+=1){const n=r[t];n[1](),W.push(n,e)}if(t){for(let t=0;t<W.length;t+=2)W[t][0](W[t+1]);W.length=0}}}return{set:l,update:function(t){l(t(e))},subscribe:function(i,s=t){const c=[i,s];return r.push(c),1===r.length&&(o=n(l)||t),i(e),()=>{const t=r.indexOf(c);-1!==t&&r.splice(t,1),0===r.length&&(o(),o=null)}}}}const et=tt([]),nt=tt([]),ot=tt(-1),rt=tt(-1),it=tt(0),lt=tt(0),st=tt({}),ct=tt(null),ut=tt([]);let at=!1;const dt=tt(null),ft=tt(null);function pt(t){dt.set(t)}function ht(t){t&&ft.set(t)}function gt(t){const{key:e,ctrlKey:n}=t;if(/Arrow/.test(e)&&t.preventDefault(),"z"===e&&n){if(!("TEXTAREA"===t.path[0].tagName))return;t.preventDefault(),async function(){let t=c(ut),e=t.findIndex((t=>t.current));if(e<=0)return!1;t[e--].current=!1,t[e].current=!0,t=[...t];const{data:n,rowIndex:o,colIndex:r}=t[e];ot.set(o),rt.set(r),at=!0,nt.set([]),await L(),nt.set(It(n)),await L(),at=!1,ut.set(t),vt()}()}if("y"===e&&n){if(!("TEXTAREA"===t.path[0].tagName))return;t.preventDefault(),async function(){let t=c(ut),e=t.findIndex((t=>t.current));if(-1===e||e>=t.length-1)return!1;at=!0,t[e++].current=!1,t[e].current=!0,t=[...t];const{data:n,rowIndex:o,colIndex:r}=t[e];ot.set(o),rt.set(r),at=!0,nt.set([]),await L(),nt.set(It(n)),await L(),at=!1,ut.set(t),vt(),t.length}()}}function mt(t){t.preventDefault();const{key:e}=t;if(/^Arrow/.test(e))return"ArrowUp"===e&&yt(-1),"ArrowDown"===e&&yt(1),"ArrowLeft"===e&&bt(-1),void("ArrowRight"===e&&bt(1));"Tab"===e&&bt(1),"Escape"===e&&(!function(){const t=c(ft);t.methods&&t.methods.restoreMethod()}(),ct.set(null)),"Delete"!==e&&"Backspace"!==e||function(t=!1){const e=c(ft);if(!e.methods)return;e.methods.clearMethod()}()}function wt(t){if(!("TEXTAREA"===t.path[0].tagName))return;let{isComposing:e,data:n,inputType:o}=t;"insertLineBreak"!==o?("insertFromPaste"===o&&(n=c(dt).value),function(){const t=c(ft);t.methods&&t.methods.focusMethod()}(),e||function(t){const e=c(ft);e.methods&&e.methods.typeInMethod(t)}(n),c(dt).value=""):yt(1)}function xt(){return[c(ot),c(rt)]}function yt(t=1){const[e,n]=[c(ot),c(it)];e<=0&&t<0||e>=n&&t>0||(ot.update((e=>e+t)),$t(),vt())}function bt(t=1){const[e,n]=[c(rt),c(lt)];e<=0&&t<0||e>=n&&t>0||(rt.update((e=>e+t)),$t(),vt())}function vt(){const t=c(ft);t&&t.scrollIntoViewIfNeeded()}function $t(){const t=c(dt);t.value="",t.focus()}function kt(t){t=Object.assign({},t);for(let e in t){const n=typeof t[e];"function"===n?delete t[e]:"object"===n&&Array.isArray(t[e])?t[e]=[]:t[e]=""}return JSON.parse(JSON.stringify(t))}function At(){st.set({})}function _t(){if(at)return;const t=(...t)=>{!function(t,e,n){if(!t||!t.length)return;const[o,r]=xt(),i={data:t,rowIndex:o,colIndex:r,current:!0};e[n]&&(e[n].current=!1);e=e.slice(0,n+1),e=(e=[...e,i]).slice(-20),ut.set(e)}(...t),function(t){const e=new CustomEvent("changed",{detail:t,bubbles:!0,cancelable:!0,composed:!0}),n=c(dt);if(!n)return;n.dispatchEvent(e)}(...t)},e=c(ut),n=JSON.parse(JSON.stringify(c(nt)));if(!e.length)return void t(n,e,-1);const o=e.findIndex((t=>t.current)),r=e[o];JSON.stringify(n)!==JSON.stringify(r.data)&&t(n,e,o)}function It(t){return JSON.parse(JSON.stringify(t))}function Mt(t,e,n){const o=t.slice();return o[64]=e[n],o[66]=n,o}function Et(t,e,n){const o=t.slice();return o[59]=e[n],o}function Nt(t,e,n){const o=t.slice();return o[59]=e[n],o}function St(t){let e,n,o,r;function i(t,e){return"nothing"===t[13]?Jt:"input"===t[13]?Ht:"date"===t[13]?Dt:"time"===t[13]?Ct:"select"===t[13]?zt:"select-multi"===t[13]?Tt:"image"===t[13]?Ot:Rt}let l=i(t),s=l(t);return{c(){e=g("div"),s.c(),y(e,"class",n="cell-wrap "+t[14]),y(e,"title",t[21]()),I(e,"active",t[3]),I(e,"editting",t[12]),I(e,"error",!!t[21]())},m(n,i){f(n,e,i),s.m(e,null),t[46](e),o||(r=x(e,"click",t[23]),o=!0)},p(t,o){l===(l=i(t))&&s?s.p(t,o):(s.d(1),s=l(t),s&&(s.c(),s.m(e,null))),16384&o[0]&&n!==(n="cell-wrap "+t[14])&&y(e,"class",n),16392&o[0]&&I(e,"active",t[3]),20480&o[0]&&I(e,"editting",t[12]),2113536&o[0]&&I(e,"error",!!t[21]())},d(n){n&&p(e),s.d(),t[46](null),o=!1,r()}}}function Rt(t){let e,n;return{c(){e=g("span"),n=m(t[1]),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){2&e[0]&&v(n,t[1])},d(t){t&&p(e)}}}function Ot(t){let e,n,o=t[1].length&&Lt(t),r=t[4].uploadApi&&Ut(t);return{c(){o&&o.c(),e=w(),r&&r.c(),n=w()},m(t,i){o&&o.m(t,i),f(t,e,i),r&&r.m(t,i),f(t,n,i)},p(t,i){t[1].length?o?o.p(t,i):(o=Lt(t),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),t[4].uploadApi?r?r.p(t,i):(r=Ut(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(t){o&&o.d(t),t&&p(e),r&&r.d(t),t&&p(n)}}}function Tt(t){let e;function n(t,e){return t[3]?jt:Bt}let o=n(t),r=o(t);return{c(){r.c(),e=w()},m(t,n){r.m(t,n),f(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&p(e)}}}function zt(t){let e;function n(t,e){return t[3]?Yt:qt}let o=n(t),r=o(t);return{c(){r.c(),e=w()},m(t,n){r.m(t,n),f(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&p(e)}}}function Ct(t){let e;function n(t,e){return t[3]?Kt:Zt}let o=n(t),r=o(t);return{c(){r.c(),e=w()},m(t,n){r.m(t,n),f(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&p(e)}}}function Dt(t){let e;function n(t,e){return t[3]?Qt:Ft}let o=n(t),r=o(t);return{c(){r.c(),e=w()},m(t,n){r.m(t,n),f(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&p(e)}}}function Ht(t){let e;function n(t,e){return t[12]?Vt:Wt}let o=n(t),r=o(t);return{c(){r.c(),e=w()},m(t,n){r.m(t,n),f(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&p(e)}}}function Jt(e){let n;return{c(){n=g("span")},m(t,e){f(t,n,e)},p:t,d(t){t&&p(n)}}}function Lt(t){let e,n=[],o=new Map,r=t[1];const i=t=>t[66];for(let e=0;e<r.length;e+=1){let l=Mt(t,r,e),s=i(l);o.set(s,n[e]=Gt(s,l))}return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=w()},m(t,o){for(let e=0;e<n.length;e+=1)n[e].m(t,o);f(t,e,o)},p(t,l){134742018&l[0]&&(r=t[1],n=K(n,l,i,1,t,r,o,e.parentNode,X,Gt,e,Mt))},d(t){for(let e=0;e<n.length;e+=1)n[e].d(t);t&&p(e)}}}function Gt(t,e){let n,i,l,s,c,u;function a(){return e[44](e[64])}return{key:t,first:null,c(){n=g("span"),i=g("img"),s=g("span"),s.textContent="×",y(i,"class","img"),i.src!==(l=e[64])&&y(i,"src",l),y(i,"alt",""),y(s,"class","img-remove"),y(s,"title","删除"),y(n,"class","img-wrap"),this.first=n},m(t,o){f(t,n,o),d(n,i),d(n,s),c||(u=[x(i,"click",a),x(s,"click",(function(){r(e[27](e[66]))&&e[27](e[66]).apply(this,arguments)})),x(n,"contextmenu",ee)],c=!0)},p(t,n){e=t,2&n[0]&&i.src!==(l=e[64])&&y(i,"src",l)},d(t){t&&p(n),c=!1,o(u)}}}function Ut(t){let e,n,r,i,l;return{c(){e=g("input"),n=g("span"),y(e,"class","file-uploader"),y(e,"type","file"),y(e,"accept",t[17]),e.disabled=t[15],y(n,"class",r="file-uploader-label "+(!t[18]||t[6]?"disabled":"")),y(n,"title","上传")},m(o,r){f(o,e,r),t[45](e),f(o,n,r),i||(l=[x(e,"change",t[26]),x(n,"click",t[25])],i=!0)},p(t,o){131072&o[0]&&y(e,"accept",t[17]),32768&o[0]&&(e.disabled=t[15]),262208&o[0]&&r!==(r="file-uploader-label "+(!t[18]||t[6]?"disabled":""))&&y(n,"class",r)},d(r){r&&p(e),t[45](null),r&&p(n),i=!1,o(l)}}}function jt(t){let e,n,r,i,l=t[16],s=[];for(let e=0;e<l.length;e+=1)s[e]=Pt(Et(t,l,e));return{c(){e=g("select"),n=g("option"),n.textContent="请选择";for(let t=0;t<s.length;t+=1)s[t].c();n.__value="",n.value=n.__value,k(n,"display","none"),y(e,"class","multi"),e.multiple=!0,e.disabled=t[15],void 0===t[5]&&G((()=>t[43].call(e)))},m(o,l){f(o,e,l),d(e,n);for(let t=0;t<s.length;t+=1)s[t].m(e,null);t[42](e),_(e,t[5]),r||(i=[x(e,"change",t[43]),x(e,"blur",t[22])],r=!0)},p(t,n){if(65536&n[0]){let o;for(l=t[16],o=0;o<l.length;o+=1){const r=Et(t,l,o);s[o]?s[o].p(r,n):(s[o]=Pt(r),s[o].c(),s[o].m(e,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}32768&n[0]&&(e.disabled=t[15]),65568&n[0]&&_(e,t[5])},d(n){n&&p(e),h(s,n),t[42](null),r=!1,o(i)}}}function Bt(t){let e,n,o=V(t[1],t[16])+"";return{c(){e=g("span"),n=m(o),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){65538&e[0]&&o!==(o=V(t[1],t[16])+"")&&v(n,o)},d(t){t&&p(e)}}}function Pt(t){let e,n,o,r=t[59].label+"";return{c(){e=g("option"),n=m(r),e.__value=o=t[59].value,e.value=e.__value,k(e,"height","25px"),k(e,"background","#fff")},m(t,o){f(t,e,o),d(e,n)},p(t,i){65536&i[0]&&r!==(r=t[59].label+"")&&v(n,r),65536&i[0]&&o!==(o=t[59].value)&&(e.__value=o,e.value=e.__value)},d(t){t&&p(e)}}}function Yt(t){let e,n,r,i,l=t[16],s=[];for(let e=0;e<l.length;e+=1)s[e]=Xt(Nt(t,l,e));return{c(){e=g("select"),n=g("option"),n.textContent="请选择";for(let t=0;t<s.length;t+=1)s[t].c();n.__value="",n.value=n.__value,k(n,"display","none"),y(e,"class","single"),e.disabled=t[15],void 0===t[5]&&G((()=>t[41].call(e)))},m(o,l){f(o,e,l),d(e,n);for(let t=0;t<s.length;t+=1)s[t].m(e,null);t[40](e),A(e,t[5]),r||(i=[x(e,"change",t[41]),x(e,"blur",t[22])],r=!0)},p(t,n){if(65536&n[0]){let o;for(l=t[16],o=0;o<l.length;o+=1){const r=Nt(t,l,o);s[o]?s[o].p(r,n):(s[o]=Xt(r),s[o].c(),s[o].m(e,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}32768&n[0]&&(e.disabled=t[15]),65568&n[0]&&A(e,t[5])},d(n){n&&p(e),h(s,n),t[40](null),r=!1,o(i)}}}function qt(t){let e,n,o=V(t[1],t[16])+"";return{c(){e=g("span"),n=m(o),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){65538&e[0]&&o!==(o=V(t[1],t[16])+"")&&v(n,o)},d(t){t&&p(e)}}}function Xt(t){let e,n,o,r=t[59].label+"";return{c(){e=g("option"),n=m(r),e.__value=o=t[59].value,e.value=e.__value},m(t,o){f(t,e,o),d(e,n)},p(t,i){65536&i[0]&&r!==(r=t[59].label+"")&&v(n,r),65536&i[0]&&o!==(o=t[59].value)&&(e.__value=o,e.value=e.__value)},d(t){t&&p(e)}}}function Kt(t){let e,n,r;return{c(){e=g("input"),y(e,"type","time"),e.disabled=t[15]},m(o,i){f(o,e,i),t[38](e),$(e,t[5]),n||(r=[x(e,"input",t[39]),x(e,"keyup",t[24]),x(e,"blur",t[22])],n=!0)},p(t,n){32768&n[0]&&(e.disabled=t[15]),65568&n[0]&&$(e,t[5])},d(i){i&&p(e),t[38](null),n=!1,o(r)}}}function Zt(t){let e,n;return{c(){e=g("span"),n=m(t[1]),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){2&e[0]&&v(n,t[1])},d(t){t&&p(e)}}}function Qt(t){let e,n,r;return{c(){e=g("input"),y(e,"type","date"),e.disabled=t[15]},m(o,i){f(o,e,i),t[36](e),$(e,t[5]),n||(r=[x(e,"input",t[37]),x(e,"keyup",t[24]),x(e,"blur",t[22])],n=!0)},p(t,n){32768&n[0]&&(e.disabled=t[15]),65568&n[0]&&$(e,t[5])},d(i){i&&p(e),t[36](null),n=!1,o(r)}}}function Ft(t){let e,n;return{c(){e=g("span"),n=m(t[1]),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){2&e[0]&&v(n,t[1])},d(t){t&&p(e)}}}function Vt(t){let e,n,r;return{c(){e=g("input"),y(e,"class",t[14]),y(e,"type","text"),e.disabled=t[15]},m(o,i){f(o,e,i),t[34](e),$(e,t[5]),n||(r=[x(e,"input",t[35]),x(e,"keyup",t[24]),x(e,"blur",t[22])],n=!0)},p(t,n){16384&n[0]&&y(e,"class",t[14]),32768&n[0]&&(e.disabled=t[15]),65568&n[0]&&e.value!==t[5]&&$(e,t[5])},d(i){i&&p(e),t[34](null),n=!1,o(r)}}}function Wt(t){let e,n,o=t[20](t[1])+"";return{c(){e=g("span"),n=m(o),y(e,"class","value")},m(t,o){f(t,e,o),d(e,n)},p(t,e){2&e[0]&&o!==(o=t[20](t[1])+"")&&v(n,o)},d(t){t&&p(e)}}}function te(e){let n,o=e[0].key&&St(e);return{c(){o&&o.c(),n=w(),this.c=t},m(t,e){o&&o.m(t,e),f(t,n,e)},p(t,e){t[0].key?o?o.p(t,e):(o=St(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&p(n)}}}const ee=t=>t.preventDefault();function ne(t,e,n){let o,r,i,l,s,d,f,p,h,g,m,w,x,y,b,v,$;u(t,ot,(t=>n(31,x=t))),u(t,rt,(t=>n(32,y=t))),u(t,it,(t=>n(51,b=t))),u(t,lt,(t=>n(52,v=t))),u(t,ct,(t=>n(19,$=t)));let{row:k={}}=e,{column:A={}}=e,{id:_=""}=e,I="",M="",E="",N=!1,S=!1,O=!1,z=null,C=null,D=null,H=null,J=null,G=null;function U(t=!1){if(S)return;if(S=!0,!o&&!t)return;if(f)return;const{valid:e,message:r=""}=B();n(1,I=M||"");const i=A.key;return n(28,k[i]=I,k),k._errorMsg[i],n(28,k._errorMsg[i]=r,k),n(28,k._id=F(),k),n(28,k={...k}),setTimeout((()=>{S=!1}),1),e}function j(t=!1){N&&!t||f||["input","select","date"].includes(i)&&(n(1,I=""),n(5,M=""),U())}function B(){const[t,e]=function(){const[t,e]=xt();return[c(nt)[t],c(et)[e]]}(),{validator:n=(()=>{})}=s,o=n(M,t,e),r={valid:!1,message:o};return o||(r.valid=!0),r}async function P(){if(!f)return N||n(30,N=!0),await L(),C?C.focus():void 0}async function Y(t){o&&(r||"input"===i&&(f||(n(30,N=!0),await L(),n(1,I=t),n(5,M=t),C.focus())))}function q(){f||(n(1,I=E),n(5,M=E),n(30,N=!1),$t())}R((()=>{!async function(){h>b&&it.set(h);g>v&&lt.set(g);await L(),n(1,I=k[A.key])}()}));return t.$$set=t=>{"row"in t&&n(28,k=t.row),"column"in t&&n(0,A=t.column),"id"in t&&n(29,_=t.id)},t.$$.update=()=>{536870912&t.$$.dirty[0]|3&t.$$.dirty[1]&&n(3,o=_===x+"."+y),1&t.$$.dirty[0]&&n(33,s=A.params||{}),268435471&t.$$.dirty[0]|4&t.$$.dirty[1]&&(o?z&&(n(2,z.methods={typeInMethod:Y,focusMethod:P,clearMethod:j,restoreMethod:q},z),ht(z)):(s.computed&&n(1,I=s.computed(k,A)),n(30,N=!1),n(5,M=I),E=I)),1073741832&t.$$.dirty[0]&&n(12,r=o&&N),1&t.$$.dirty[0]&&n(13,i=A.type||"input"),1&t.$$.dirty[0]&&n(4,l=A.props||{}),1&t.$$.dirty[0]&&n(14,d="right"===A.align?"t-right":"center"===A.align?"t-center":"t-left"),17&t.$$.dirty[0]|4&t.$$.dirty[1]&&n(15,f=A.disabled||l.disabled||!!s.computed),17&t.$$.dirty[0]&&n(16,p=A.items||l.items||[]),536870912&t.$$.dirty[0]&&(h=+_.split(".")[0]),536870912&t.$$.dirty[0]&&(g=+_.split(".")[1]),16&t.$$.dirty[0]&&n(17,m=l.accept||"image/*"),18&t.$$.dirty[0]&&n(18,w=(l.max||100)>(I||[]).length)},[A,I,z,o,l,M,O,C,D,H,J,G,r,i,d,f,p,m,w,$,function(t){null==t&&(t="");const{formatter:e=(t=>t)}=s,{valid:n}=B();return!0!==n?t:e(t)},function(){const t=A.key;if(!t||!k._errorMsg)return;return k._errorMsg[t]},U,function(t){const e=t.path[0],{tagName:r}=e;var i,l;if(["SPAN","DIV","IMG"].includes(r))if(o){if(f)return;n(30,N=!0),P()}else i=h,l=g,ot.set(+i),rt.set(+l),$t()},function(t){13===t.keyCode&&(U(),n(30,N=!1),yt(1))},function(){w&&(O||G.click())},function(t){const e=G.files[0];if(n(11,G.value=null,G),!e||!l.uploadApi)return;const o=new FormData;o.append("file",e),n(6,O=!0),fetch(l.uploadApi,{method:"POST",body:o}).then((t=>t.json())).then((t=>{const e=t=>{const n=typeof t;let o;if(t){if("string"===n&&/^https?:\/\//.test(t))return t;if("object"===n)for(let n in t)if(o=e(t[n]),o)break;return o}},o=e(t);o&&n(1,I=[...I,o])})).catch((t=>{console.error(t)})).finally((()=>{n(6,O=!1)}))},function(t){I.splice(t,1),n(1,I=[...I])},k,_,N,x,y,s,function(t){T[t?"unshift":"push"]((()=>{C=t,n(7,C)}))},function(){M=this.value,n(5,M),n(3,o),n(33,s),n(28,k),n(0,A),n(1,I),n(2,z),n(29,_),n(31,x),n(32,y),n(16,p),n(0,A),n(4,l)},function(t){T[t?"unshift":"push"]((()=>{H=t,n(9,H)}))},function(){M=this.value,n(5,M),n(3,o),n(33,s),n(28,k),n(0,A),n(1,I),n(2,z),n(29,_),n(31,x),n(32,y),n(16,p),n(0,A),n(4,l)},function(t){T[t?"unshift":"push"]((()=>{J=t,n(10,J)}))},function(){M=this.value,n(5,M),n(3,o),n(33,s),n(28,k),n(0,A),n(1,I),n(2,z),n(29,_),n(31,x),n(32,y),n(16,p),n(0,A),n(4,l)},function(t){T[t?"unshift":"push"]((()=>{D=t,n(8,D)}))},function(){M=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(5,M),n(3,o),n(33,s),n(28,k),n(0,A),n(1,I),n(2,z),n(29,_),n(31,x),n(32,y),n(16,p),n(0,A),n(4,l)},function(t){T[t?"unshift":"push"]((()=>{D=t,n(8,D)}))},function(){var t;t=this,M=[].map.call(t.querySelectorAll(":checked"),(t=>t.__value)),n(5,M),n(3,o),n(33,s),n(28,k),n(0,A),n(1,I),n(2,z),n(29,_),n(31,x),n(32,y),n(16,p),n(0,A),n(4,l)},t=>a(ct,$=t,$),function(t){T[t?"unshift":"push"]((()=>{G=t,n(11,G)}))},function(t){T[t?"unshift":"push"]((()=>{z=t,n(2,z),n(3,o),n(33,s),n(28,k),n(0,A),n(1,I),n(29,_),n(31,x),n(32,y)}))}]}function oe(t){let e,n,o,r,i=t[3]&&re(t),l=t[2]&&ie(t);return{c(){e=g("div"),i&&i.c(),n=w(),l&&l.c(),y(e,"class","menu-wrap"),y(e,"style",t[4])},m(s,c){f(s,e,c),i&&i.m(e,null),d(e,n),l&&l.m(e,null),o||(r=x(e,"click",t[14]),o=!0)},p(t,o){t[3]?i?i.p(t,o):(i=re(t),i.c(),i.m(e,n)):i&&(i.d(1),i=null),t[2]?l?l.p(t,o):(l=ie(t),l.c(),l.m(e,null)):l&&(l.d(1),l=null),16&o&&y(e,"style",t[4])},d(t){t&&p(e),i&&i.d(),l&&l.d(),o=!1,r()}}}function re(t){let e,n,r,i,l,s,c,u,a=t[5]?`第${t[3]}行`:`Row ${t[3]}`,h=t[5]?"插入行":"Insert line",w=t[5]?"删除行":"Delete line";return{c(){e=g("div"),n=m(a),r=g("div"),i=m(h),l=g("div"),s=m(w),y(e,"class","line title"),y(r,"class","line item"),y(l,"class","line item danger")},m(o,a){f(o,e,a),d(e,n),f(o,r,a),d(r,i),f(o,l,a),d(l,s),c||(u=[x(r,"click",t[11]),x(l,"click",t[13])],c=!0)},p(t,e){40&e&&a!==(a=t[5]?`第${t[3]}行`:`Row ${t[3]}`)&&v(n,a),32&e&&h!==(h=t[5]?"插入行":"Insert line")&&v(i,h),32&e&&w!==(w=t[5]?"删除行":"Delete line")&&v(s,w)},d(t){t&&p(e),t&&p(r),t&&p(l),c=!1,o(u)}}}function ie(t){let e,n,o,r;return{c(){e=g("div"),n=m("第"),o=m(t[2]),r=m("列"),y(e,"class","line title")},m(t,i){f(t,e,i),d(e,n),d(e,o),d(e,r)},p(t,e){4&e&&v(o,t[2])},d(t){t&&p(e)}}}function le(e){let n,o=e[1]&&oe(e);return{c(){o&&o.c(),n=w(),this.c=t},m(t,e){o&&o.m(t,e),f(t,n,e)},p(t,[e]){t[1]?o?o.p(t,e):(o=oe(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&p(n)}}}function se(t,e,n){let o,r,i,l,s,a,d,f,p,h;function g(t){t.stopPropagation(),At()}u(t,st,(t=>n(7,h=t)));return t.$$.update=()=>{128&t.$$.dirty&&n(0,o=h),1&t.$$.dirty&&n(1,r=o.show||!1),1&t.$$.dirty&&n(8,i=o.x||0),1&t.$$.dirty&&n(9,l=o.y||0),1&t.$$.dirty&&n(2,s=void 0===o.colIndex?void 0:o.colIndex+1),1&t.$$.dirty&&n(3,a=void 0===o.rowIndex?void 0:o.rowIndex+1),768&t.$$.dirty&&n(4,d=`top: ${l}px; left: ${i}px;`),1024&t.$$.dirty&&n(5,p=/zh-/i.test(f))},n(10,f=document.querySelector("html").getAttribute("lang")||""),[o,r,s,a,d,p,g,h,i,l,f,()=>{return t=o.rowIndex,nt.update((e=>{let n=e[t];return n=kt(n),n._id=F(),e.splice(t,0,n),e})),void it.update((t=>++t));var t},()=>{return t=o.rowIndex,void nt.update((e=>{let n=e[t];return n=kt(n),e.splice(t,1,n),e}));var t},()=>function(t){let e=c(nt);e.splice(t,1),nt.set(e),it.update((t=>--t))}(o.rowIndex),t=>g(t)]}customElements.define("sheet-cell",class extends Q{constructor(t){super(),this.shadowRoot.innerHTML="<style>.t-left{text-align:left}.t-center{text-align:center}.t-right{text-align:right}.cell-wrap{position:relative;width:100%;min-height:31px;height:100%;padding:3px 10px;box-sizing:border-box;font-size:15px;line-height:25px;overflow:visible}.cell-wrap.active{outline:2px solid #5292f7}.cell-wrap.error{outline:1px solid #f55}.cell-wrap.error.active{outline-width:2px}.cell-wrap span.value{display:block;max-width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:default}.cell-wrap .img-wrap{position:relative;display:inline-block;vertical-align:top;width:25px;height:25px;transition:transform 0.15s}.cell-wrap .img-wrap:hover{transform:scale(1.4);z-index:1}.cell-wrap .img-wrap:hover .img-remove{display:block}.cell-wrap .img-wrap+.img-wrap{margin-left:5px}.cell-wrap .img-wrap .img{position:relative;display:block;min-width:25px;min-height:25px;max-width:25px;max-height:25px;cursor:pointer}.cell-wrap .img-wrap .img-remove{display:none;position:absolute;z-index:1;top:-4px;right:-4px;width:14px;height:14px;line-height:13px;border-radius:50%;transform:scale(0.7);text-align:center;user-select:none;background:red;color:#fff;cursor:pointer}.cell-wrap .file-uploader{position:absolute;top:-2px;left:-2px;width:1px;height:1px;opacity:0}.cell-wrap .file-uploader-label{position:absolute;width:16px;height:16px;right:10px;top:7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAB+klEQVRYR+2WsU4bQRCG/9k9UFJRIqEookgaisjePQU5aUJHSZG4gIJYlmiSd8C8RKooQkKQKBRJkxoqGnsPhyJNUqSDPqIxtwxafAaDsO9ubWShcM3N3e3M/83caHYJI75oxPrwBigUghdS8g8AY8x4H0V23ScZL4BicSwU4vQbgEddomVj7HZeiNwAYRi8ZOYtAI9vEMsNkQtA62AO4M8AJvtkmgsiM4BSwTwRfwEwkYi7cr9J7K8Ayj6/IxOA1nIBgMv8QSLygYi2mXnHPRORq8xrZrzLC5EKMDuLyTiWR53AzPgURbYahsGrboBGI97VWn4EUL2EsFPG4LBfY6YCKDX+jMj+TIJsGWOXnH0TgHuvtdwEsOhsIcTzev2kPhBAqYSHrZaoENG/RsNudIL1AnDflZIrAI7j2H4/OMDxQAC9nPsB5JkFqb/gHuD/qkChgOlmE3+zNJFvE17XuGjCMJR7zCgxo5Jla/UB0Fq60e3GtjHGhudTtJOt1pKdzcxrUXRaS6uCD4BSokZEqy62MfZc+x7g7lZAKTwhkr/bfWOfRhH+pPXNUHvAiRWLmHH3/X38ShNvb1JDbMIsgtfX3B0An+yy+vScA93lyRpsgHXrxtjKlUGUTLZlAG8HCJzq6iatEGLXnSGvAKR63tIC7xPRsHhGDnAG+mhhMH7U/JEAAAAASUVORK5CYII=) 0 0 no-repeat;background-size:16px 16px;cursor:pointer}.cell-wrap .file-uploader-label.disabled{opacity:0.25;cursor:not-allowed}.cell-wrap input{border:none;outline:none;width:100%;height:100%;padding:0;font-size:15px}.cell-wrap input[disabled]{background:#fff}.cell-wrap select{position:absolute;z-index:1;top:0;left:0;width:100%;padding:0 6px;margin:0;border:none;outline:none;font-size:15px;overflow-y:auto}.cell-wrap select.single{height:100%}.cell-wrap select.multi{box-shadow:0 0 5px #888}</style>",Z(this,{target:this.shadowRoot,props:M(this.attributes)},ne,te,l,{row:28,column:0,id:29},[-1,-1,-1]),t&&(t.target&&f(t.target,this,t.anchor),t.props&&(this.$set(t.props),B()))}static get observedAttributes(){return["row","column","id"]}get row(){return this.$$.ctx[28]}set row(t){this.$set({row:t}),B()}get column(){return this.$$.ctx[0]}set column(t){this.$set({column:t}),B()}get id(){return this.$$.ctx[29]}set id(t){this.$set({id:t}),B()}});function ce(t){let e,n,r,i,l,s,c;return{c(){e=g("div"),n=g("img"),i=g("div"),i.textContent="×",y(n,"class","img"),n.src!==(r=t[1])&&y(n,"src",r),y(n,"alt",""),k(n,"transform","scale("+t[2]+")"),y(i,"class","close"),y(e,"class",l="mask "+(t[0]?"fading-out":""))},m(o,r){f(o,e,r),d(e,n),d(e,i),s||(c=[x(n,"click",ae),x(n,"dragstart",de),x(i,"click",t[5]),x(e,"mousewheel",t[4])],s=!0)},p(t,o){2&o&&n.src!==(r=t[1])&&y(n,"src",r),4&o&&k(n,"transform","scale("+t[2]+")"),1&o&&l!==(l="mask "+(t[0]?"fading-out":""))&&y(e,"class",l)},d(t){t&&p(e),s=!1,o(c)}}}function ue(e){let n,o=e[3]&&ce(e);return{c(){o&&o.c(),n=w(),this.c=t},m(t,e){o&&o.m(t,e),f(t,n,e)},p(t,[e]){t[3]?o?o.p(t,e):(o=ce(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&p(n)}}}customElements.define("context-menu",class extends Q{constructor(t){super(),this.shadowRoot.innerHTML="<style>.menu-wrap{position:absolute;width:94px;background-color:#fff;box-shadow:0 0 4px #aaa;z-index:9}.menu-wrap .line{line-height:32px;font-size:14px;color:#888;text-align:center;cursor:default;white-space:nowrap}.menu-wrap .line.title{margin:0 10px;border-bottom:1px solid #eee}.menu-wrap .line.item{font-size:15px;color:#333;cursor:pointer}.menu-wrap .line.item:hover{background:#f1f1f1}.menu-wrap .line.item.danger:hover{background:#fff1f1}</style>",Z(this,{target:this.shadowRoot,props:M(this.attributes)},se,le,i,{}),t&&t.target&&f(t.target,this,t.anchor)}});const ae=t=>t.stopPropagation(),de=t=>t.preventDefault();function fe(t,e,n){let o,r;u(t,ct,(t=>n(1,r=t)));let i=!1,l=1;return t.$$.update=()=>{3&t.$$.dirty&&n(3,o=r||i)},[i,r,l,o,function(t){const{deltaY:e}=t;if(e<0){if(l>=2)return;n(2,l+=.1)}else{if(l<=.5)return;n(2,l-=.1)}},function(){a(ct,r=null,r),n(0,i=!0),setTimeout((()=>{n(0,i=!1),n(2,l=1)}),300)}]}function pe(t,e,n){const o=t.slice();return o[16]=e[n],o[18]=n,o}function he(t,e,n){const o=t.slice();return o[19]=e[n],o[21]=n,o}function ge(t,e,n){const o=t.slice();return o[19]=e[n],o[21]=n,o}function me(t,e,n){const o=t.slice();return o[19]=e[n],o[21]=n,o}function we(t){let e;return{c(){e=g("colgroup")},m(t,n){f(t,e,n)},d(t){t&&p(e)}}}function xe(t,e){let n,o;return{key:t,first:null,c(){n=g("colgroup"),y(n,"style",o=e[19].width?`width: ${e[19].width}`:""),this.first=n},m(t,e){f(t,n,e)},p(t,r){e=t,8&r&&o!==(o=e[19].width?`width: ${e[19].width}`:"")&&y(n,"style",o)},d(t){t&&p(n)}}}function ye(e){let n,o,r;return{c(){n=g("th"),n.textContent="#",y(n,"class","row-head")},m(t,i){f(t,n,i),o||(r=x(n,"contextmenu",e[12]),o=!0)},p:t,d(t){t&&p(n),o=!1,r()}}}function be(t,e){let n,o,r,i,l=e[19].text+"";return{key:t,first:null,c(){n=g("th"),o=m(l),I(n,"highlight",e[21]===e[4]),this.first=n},m(t,l){f(t,n,l),d(n,o),r||(i=x(n,"contextmenu",e[13]),r=!0)},p(t,r){e=t,8&r&&l!==(l=e[19].text+"")&&v(o,l),24&r&&I(n,"highlight",e[21]===e[4])},d(t){t&&p(n),r=!1,i()}}}function ve(t){let e,n,o,r,i=t[18]+1+"";function l(...e){return t[14](t[18],...e)}return{c(){e=g("td"),n=m(i),y(e,"class","row-head"),I(e,"highlight",t[18]===t[6])},m(t,i){f(t,e,i),d(e,n),o||(r=x(e,"contextmenu",l),o=!0)},p(o,r){t=o,32&r&&i!==(i=t[18]+1+"")&&v(n,i),96&r&&I(e,"highlight",t[18]===t[6])},d(t){t&&p(e),o=!1,r()}}}function $e(t,e){let n,o,r,i,l;return{key:t,first:null,c(){n=g("td"),o=g("sheet-cell"),b(o,"row",r=e[16]),b(o,"column",i=e[19]),b(o,"id",l=e[18]+"."+e[21]),this.first=n},m(t,e){f(t,n,e),d(n,o)},p(t,n){e=t,32&n&&r!==(r=e[16])&&b(o,"row",r),8&n&&i!==(i=e[19])&&b(o,"column",i),40&n&&l!==(l=e[18]+"."+e[21])&&b(o,"id",l)},d(t){t&&p(n)}}}function ke(t,e){let n,o,r=[],i=new Map,l=e[1]&&ve(e),s=e[3];const c=t=>t[21];for(let t=0;t<s.length;t+=1){let n=he(e,s,t),o=c(n);i.set(o,r[t]=$e(o,n))}return{key:t,first:null,c(){n=g("tr"),l&&l.c(),o=w();for(let t=0;t<r.length;t+=1)r[t].c();this.first=n},m(t,e){f(t,n,e),l&&l.m(n,null),d(n,o);for(let t=0;t<r.length;t+=1)r[t].m(n,null)},p(t,u){(e=t)[1]?l?l.p(e,u):(l=ve(e),l.c(),l.m(n,o)):l&&(l.d(1),l=null),40&u&&(s=e[3],r=K(r,u,c,1,e,s,i,n,X,$e,null,he))},d(t){t&&p(n),l&&l.d();for(let t=0;t<r.length;t+=1)r[t].d()}}}function Ae(e){let n,r,i,l,s,c,u,a,h,m,b,v,$=[],k=new Map,A=[],_=new Map,I=[],M=new Map,E=e[1]&&we(),N=e[3];const S=t=>t[21];for(let t=0;t<N.length;t+=1){let n=me(e,N,t),o=S(n);k.set(o,$[t]=xe(o,n))}let R=e[1]&&ye(e),O=e[3];const T=t=>t[21];for(let t=0;t<O.length;t+=1){let n=ge(e,O,t),o=T(n);_.set(o,A[t]=be(o,n))}let z=e[5];const C=t=>t[16][t[0]];for(let t=0;t<z.length;t+=1){let n=pe(e,z,t),o=C(n);M.set(o,I[t]=ke(o,n))}return{c(){n=g("div"),r=g("image-preview"),i=g("textarea"),l=g("context-menu"),s=g("table"),E&&E.c(),c=w();for(let t=0;t<$.length;t+=1)$[t].c();u=g("thead"),a=g("tr"),R&&R.c(),h=w();for(let t=0;t<A.length;t+=1)A[t].c();m=g("tbody");for(let t=0;t<I.length;t+=1)I[t].c();this.c=t,y(i,"type","hidden"),y(n,"class","sheet-wrap")},m(t,o){f(t,n,o),d(n,r),d(n,i),e[11](i),d(n,l),d(n,s),E&&E.m(s,null),d(s,c);for(let t=0;t<$.length;t+=1)$[t].m(s,null);d(s,u),d(u,a),R&&R.m(a,null),d(a,h);for(let t=0;t<A.length;t+=1)A[t].m(a,null);d(s,m);for(let t=0;t<I.length;t+=1)I[t].m(m,null);b||(v=[x(window,"keydown",gt),x(window,"keyup",mt),x(window,"input",wt),x(n,"click",e[8])],b=!0)},p(t,[e]){t[1]?E||(E=we(),E.c(),E.m(s,c)):E&&(E.d(1),E=null),8&e&&(N=t[3],$=K($,e,S,1,t,N,k,s,X,xe,u,me)),t[1]?R?R.p(t,e):(R=ye(t),R.c(),R.m(a,h)):R&&(R.d(1),R=null),24&e&&(O=t[3],A=K(A,e,T,1,t,O,_,a,X,be,null,ge)),235&e&&(z=t[5],I=K(I,e,C,1,t,z,M,m,X,ke,null,pe))},i:t,o:t,d(t){t&&p(n),e[11](null),E&&E.d();for(let t=0;t<$.length;t+=1)$[t].d();R&&R.d();for(let t=0;t<A.length;t+=1)A[t].d();for(let t=0;t<I.length;t+=1)I[t].d();b=!1,o(v)}}}function _e(t,e,n){let o,r,i,l;u(t,et,(t=>n(3,o=t))),u(t,rt,(t=>n(4,r=t))),u(t,nt,(t=>n(5,i=t))),u(t,ot,(t=>n(6,l=t)));let{columns:s=[]}=e,{data:c=[]}=e,{key:a="_id"}=e,{showrowindex:d=!0}=e,f=null;var p;function h(t,e,n){t.preventDefault();const{layerX:o,layerY:r}=t;!function({x:t=0,y:e=0,rowIndex:n,colIndex:o}){const r={show:!0,x:t,y:e,rowIndex:n,colIndex:o};st.set(r)}({x:o,y:r,rowIndex:e,colIndex:n})}R((()=>{pt(f),setTimeout((()=>{!function(t,e,n){et.set(e),t.forEach((t=>{"_id"===n&&(t._id=F()),t._errorMsg={}})),nt.set(t)}(c,s,a)}),100)})),p=()=>{s.length&&c.length&&_t()},S().$$.after_update.push(p);return t.$$set=t=>{"columns"in t&&n(9,s=t.columns),"data"in t&&n(10,c=t.data),"key"in t&&n(0,a=t.key),"showrowindex"in t&&n(1,d=t.showrowindex)},[a,d,f,o,r,i,l,h,function(){At()},s,c,function(t){T[t?"unshift":"push"]((()=>{f=t,n(2,f)}))},t=>At()||t.preventDefault(),t=>At()||t.preventDefault(),(t,e)=>h(e,t)]}customElements.define("image-preview",class extends Q{constructor(t){super(),this.shadowRoot.innerHTML="<style>.mask{position:fixed;z-index:2999;top:0;left:0;width:100vw;height:100vh;background:rgba(0, 0, 0, 0.45);user-select:none;animation:fadeIn 0.3s}.mask.fading-out{animation:fadeOut 0.305s}.mask .img{display:block;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto auto;width:30vw;height:auto;transition:all 0.15s}.mask .close{position:absolute;top:25px;right:30px;width:34px;height:34px;border-radius:50%;border:3px solid #fff;color:#fff;text-align:center;line-height:32px;font-size:34px;opacity:0.85;cursor:pointer}.mask .close:hover{opacity:1}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{from{opacity:1}to{opacity:0}}</style>",Z(this,{target:this.shadowRoot,props:M(this.attributes)},fe,ue,l,{}),t&&t.target&&f(t.target,this,t.anchor)}});class Ie extends Q{constructor(t){super(),this.shadowRoot.innerHTML="<style>textarea{position:fixed;top:0;left:0;width:0;height:0;opacity:0}.sheet-wrap{position:relative}.sheet-wrap table{position:relative;width:100%;padding:0;margin:0;overflow:visible;border-collapse:collapse;table-layout:fixed}.sheet-wrap table tr th,.sheet-wrap table tr td{min-height:25px;padding:0;border:1px solid #ddd;box-sizing:border-box;background-color:#fff}.sheet-wrap table tr th.row-head,.sheet-wrap table tr td.row-head{width:35px;background-color:#f8f8f8;color:#555;font-size:13.5px;box-sizing:border-box;text-align:center;white-space:nowrap;user-select:none}.sheet-wrap table tr th.highlight,.sheet-wrap table tr td.highlight{background-color:#ddd}.sheet-wrap table thead{position:relative}.sheet-wrap table thead th{position:sticky;top:0;z-index:1;transform:translateY(-1px);border-top-width:2px;background-color:#f8f8f8;color:#555}</style>",Z(this,{target:this.shadowRoot,props:M(this.attributes)},_e,Ae,i,{columns:9,data:10,key:0,showrowindex:1}),t&&(t.target&&f(t.target,this,t.anchor),t.props&&(this.$set(t.props),B()))}static get observedAttributes(){return["columns","data","key","showrowindex"]}get columns(){return this.$$.ctx[9]}set columns(t){this.$set({columns:t}),B()}get data(){return this.$$.ctx[10]}set data(t){this.$set({data:t}),B()}get key(){return this.$$.ctx[0]}set key(t){this.$set({key:t}),B()}get showrowindex(){return this.$$.ctx[1]}set showrowindex(t){this.$set({showrowindex:t}),B()}}return customElements.define("spread-sheet",Ie),Ie}));
